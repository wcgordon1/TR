---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout.astro";
import Entries from "@/components/jobs/Entries.astro";
import SearchJobs from "@/components/jobs/SearchJobs.astro";

const allPosts = await getCollection("jobs");

// Format salary for display
function formatSalary(baseSalary) {
  const { currency, minValue, maxValue, unitText } = baseSalary;
  return `${currency} ${minValue.toLocaleString()}-${maxValue.toLocaleString()} per ${unitText.toLowerCase()}`;
}
---

<BaseLayout>
  <section>
    <header class="px-8 mx-auto max-w-7xl lg:px-16 xl:px-24 pt-8">
      <div
        class="p-8 lg:px-20 lg:py-32 rounded-3xl bg-gradient-to-tr from-purple-900 via-purple-800 to-blue-700">
        <div class="text-center max-w-xl mx-auto">
          <span
            class="text-white text-sm leading-6 px-4 py-2 relative bg-white/10 ring-1 ring-white/20 rounded-full"
            >Find your next opportunity</span
          >
          <h1
            class="text-white font-semibold tracking-tight lg:text-5xl mt-8 text-3xl lg:text-balance">
            Tustin Recruiting Jobs
          </h1>
          <p class="text-slate-300 mt-5 lg:text-pretty">
            Discover roles at innovative companies. Our recruiters connect talented professionals with opportunities that match their skills and aspirations.

          </p>
        </div>
      </div>
    </header>
    <div class="mx-auto max-w-7xl lg:px-16 md:px-12 px-8 xl:px-24">
      <SearchJobs />
      <div class="mt-12 lg:flex lg:gap-x-16">
        <div class="lg:w-2/3">
          <ul role="list" class="divide-y divide-slate-100">
            {
              allPosts.map((post) => (
                <Entries
                  url={"/jobs/" + post.slug}
                  position={post.data.position}
                  location={post.data.location}
                  team={post.data.team}
                  company={post.data.hiringOrganization.name}
                  companyLogo={post.data.hiringOrganization.logo}
                  salary={formatSalary(post.data.baseSalary)}
                  type={post.data.employmentType}
                  description={post.data.description}
                  category={post.data.occupationalCategory}
                />
              ))
            }
          </ul>
        </div>
        <div class="lg:w-1/3">
          <div class="lg:sticky lg:top-8">
            <div class="bg-slate-50 rounded-lg divide-y space-y-3 p-4 lg:p-8">
              <div>
                <h3 class="text-lg font-medium text-purple-900">Quick Links</h3>
                <div class="mt-4 space-y-2">
                  <a
                    href="/jobs/job-application"
                    class="text-white items-center font-medium gap-3 inline-flex focus-visible:outline-2 focus-visible:outline-offset-2 focus:outline-none justify-center px-6 ring-2 ring-transparent focus:ring-offset-2 focus:ring-blue-500 duration-200 py-3.5 rounded-full active:bg-blue-800 active:text-white bg-blue-500 hover:bg-blue-600 w-full"
                  >
                    Apply Now
                  </a>
                </div>
              </div>
              <div class="pt-6">
                <h3 class="text-lg font-medium text-purple-900">Resources</h3>
                <ul class="mt-4 space-y-3">
                  <li>
                    <a href="#" class="text-slate-500 hover:text-blue-600">How to Apply</a>
                  </li>
                  <li>
                    <a href="#" class="text-slate-500 hover:text-blue-600">FAQ</a>
                  </li>
                  <li>
                    <a href="#" class="text-slate-500 hover:text-blue-600">Benefits</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
